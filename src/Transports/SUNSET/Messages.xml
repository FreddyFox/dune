<?xml version="1.0" encoding="UTF-8"?>
<!--
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Copyright (C) 2007-2014 Laboratório de Sistemas e Tecnologia Subaquática   +
+ Departamento de Engenharia Electrotécnica e de Computadores                +
+ Rua Dr. Roberto Frias, 4200-465 Porto, Portugal                            +
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-->
<messages name="SUNSET">
  <types>
    <description>
      Messages and packets can be viewed as a finite collection of
      fields. The list of valid field types is presented below.
    </description>
    <type name="int8_t" size="1">
      <description>
        8 bit signed integer.
      </description>
    </type>
    <type name="uint8_t" size="1">
      <description>
        8 bit unsigned integer.
      </description>
    </type>
    <type name="int16_t" size="2">
      <description>
        16 bit signed integer.
      </description>
    </type>
    <type name="uint16_t" size="2">
      <description>
        16 bit unsigned integer.
      </description>
    </type>
    <type name="int32_t" size="4">
      <description>
        32 bit signed integer.
      </description>
    </type>
    <type name="uint32_t" size="4">
      <description>
        32 bit unsigned integer.
      </description>
    </type>
    <type name="int64_t" size="8">
      <description>
        A 64 bit signed integer
      </description>
    </type>
    <type name="fp32_t" size="4">
      <description>
        32 bit single precision floating point number in IEEE 754 format.
      </description>
    </type>
    <type name="fp64_t" size="8">
      <description>
        64 bit double precision floating point number in IEEE 754 format.
      </description>
    </type>
    <type name="rawdata">
      <description>
        Variable length byte stream.
      </description>
    </type>
    <type name="plaintext">
      <description>
        Variable length ASCII character stream.
      </description>
    </type>
  </types>

  <units>
    <description>
      The following table lists the units used in the subsequent
      chapters.
    </description>
    <unit abbrev="byte" name="Byte"/>
    <unit abbrev="s" name="Second"/>
    <unit abbrev="Enumerated" name="Enumeration of integer values"/>
    <unit abbrev="Bitfield" name="Bit field"/>
  </units>

  <message name="UAM - Packet Received" abbrev="UamPacketRx" source="vehicle,ccu">
    <description>
      Notification of packet reception.
    </description>

    <field name="Flags" abbrev="flags" type="uint8_t" unit="Bitfield" prefix="UPR">
      <description>
        Packet flags.
      </description>
      <value abbrev="PROMISC" name="Packet is promiscuous" id="0x01"/>
    </field>

    <field name="Source Address" abbrev="addr_src" type="uint16_t">
      <description>
        Address of the originating acoustic modem.
      </description>
    </field>

    <field name="Destination Address" abbrev="addr_dst" type="uint16_t">
      <description>
        Address of the destination acoustic modem.
      </description>
    </field>

    <field name="Data" abbrev="data" type="rawdata">
      <description>
        Sequence of data bytes.
      </description>
    </field>
  </message>

  <message name="UAM - Request Packet Transmission" abbrev="UamPacketTx" source="vehicle,ccu">
    <description>
      Request packet transmission.
    </description>

    <field name="Sequence Number" abbrev="seq" type="uint16_t">
      <description>
        Unique request identifier.
      </description>
    </field>

    <field name="Time to Live" abbrev="ttl" type="uint16_t" unit="s">
      <description>
        Time, in seconds, after which there will be no more atempts to
        transmit the message.
      </description>
    </field>

    <field name="Destination Address" abbrev="addr_dst" type="uint16_t">
      <description>
        Address of the destination acoustic modem.
      </description>
    </field>

    <field name="Data" abbrev="data" type="rawdata">
      <description>
        Sequence of data bytes.
      </description>
    </field>
  </message>

  <message name="UAM - Cancel Packet Transmission Request" abbrev="UamPacketTxCancel" source="vehicle,ccu">
    <description>
      Request to cancel on-going packet transmission.
    </description>

    <field name="Sequence Number" abbrev="seq" type="uint16_t">
      <description>
        Unique request identifier.
      </description>
    </field>
  </message>

  <message name="UAM - Packet Transmission Status" abbrev="UamPacketTxStatus" source="vehicle,ccu">
    <description>
      Status of a packet transmission request.
    </description>

    <field name="Sequence Number" abbrev="seq" type="uint16_t">
      <description>
        Unique request identifier.
      </description>
    </field>

    <field name="Status Code" abbrev="status" type="uint8_t" unit="Enumerated" prefix="UTS">
      <description>
        Status code of the transmission request.
      </description>

      <value abbrev="OK" name="Successfull transmission" id="0"/>
      <value abbrev="ERROR" name="Error while trying to transmit packet" id="1"/>
      <value abbrev="QUEUED" name="Packet has been queued for transmission" id="2"/>
      <value abbrev="TRANSMIT" name="Packet is currently being transmitted" id="3"/>
      <value abbrev="EXPIRED" name="Packet transmission request expired" id="4"/>
      <value abbrev="CANCELLED" name="Packet transmission has been cancelled." id="5"/>
    </field>

    <field name="Status Text" abbrev="text" type="plaintext">
      <description>
        Human-readable transmission status.
      </description>
    </field>
  </message>
</messages>
